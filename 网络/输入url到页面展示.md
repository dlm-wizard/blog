

1. DNS 解析:将域名解析成 IP 地址
2. TCP 连接：TCP 三次握手
3. 发送 HTTP 请求
4. 服务器处理请求并返回 HTTP 报文
5. 浏览器解析渲染页面
6. 断开连接：TCP 四次挥手



#
#### 查找缓存

1. 浏览器缓存
2. isp 互联网服务提供商 的 dns 服务器缓存
3. dns 迭代查询

#
#### DNS 解析

> 将域名解析成服务器的 IP 地址 [IP地址是和网卡绑定的，一个服务器可以有多个网卡，也就是可能有多个IP地址]

#### DNS 基础知识

```bash
# 域名系统

输入 www.google.com, 实际上是访问了不同的域 ['.' 分割，从右向左]
'.': 根域
'.com': 顶级域
'google.com': 二级域
'www.google.com': 子域

# 权威 dns 服务器：经过上述授权，对域名进行解析的服务器 [域名出售商提供]


# 主域与次域 [父域与子域] 

相对的表达：如'www.google.com'(子域)与'google.com'(主域)
```

![dns解析过程](https://pic1.zhimg.com/v2-b6cf454b2fc9144470f097c827a13ab0_b.jpg)

```bash
# DNS 解析过程
1. 浏览器向本地 DNS 服务器发起请求，如果本地 DNS 服务器没有缓存不能直接将域名转换为 IP 地址

2. 需要采用递归或者迭代查询的方式，依次向根域名服务器、顶级域名服务器、权威域名服务器发起查询请求，直至找到一个或一组 
IP 地址，返回给浏览器

注：先一般都是迭代查询


# 本地 DNS 服务器
1. 本地 DNS 地址由 ISP（Internet Service Provider，互联网服务提供商）通过 DHCP 协议动态分配

2. 可以手动修改为公共 dns，Google 提供的 8.8.8.8，国内的 114.114.114.114，它们分布在不同的地理位置上，借助 
Anycast 技术，将请求路由到离用户最近的 DNS 服务器上
```

#### 递归查询与迭代查询

```bash
# 递归查询:

如果浏览器所询问的本地域名服务器不知道被查询的域名的IP地址，那么本地域名服务器就以 DNS 客户的身份，向其它根域
名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。

# 迭代查询: 

本地域名服务器向根域名服务器查询的方式。根域名服务器会告诉本地域名服务器下一步的查询地址。为了提高 DNS 查询效率，
并减轻服务器的负荷和减少因特网上的DNS查询报文数量，在域名服务器中广泛使用了高速缓存，用来存放最近查询过的域名以及
从何处获得域名映射信息的记录。
```

### TTL与缓存

> 每次都发送一次DNS请求，服务器负载太大

```bash
# TTL：Time- To-Live
{域名: ip}在权威域名服务器上存在的时间，用户根据TTL值缓存在本地
```

#
#### CDN [内容分发网络]

> 那么这个问题的根本原因是网络传输是依赖于网线的，网线越长，那么时间肯定就越久 [服务器需要布置在各地]

#### 集群与cdn

```bash、
# 服务器上的资源分为两种：

静态资源：HTML、CSS、JavaScript、音乐、图片、视频 [资源很少变动]
动态资源：ftl，jsp [不同用户不同时刻访问不同]


# 集群
百度要在全国各地都部署服务器，如果说每个服务器上都有相同的动态资源，那么可能还需要配置相应的数据库

1. 动态资源所记录的信息通常会存储在数据库中

2. 涉及到了数据同步等等问题，这会导致成本很高


# cdn [服务器上只部署静态资源]

阿里，腾讯等等都有自己的CDN服务，只要你自己的系统接入了这些大厂所提供的CDN服务，你把自己的静态资源传给
CDN服务商，那么这些静态资源将自动的分布到全世界各地去
```

#### cname [解析域名到域名]

> 就是利用DNS的重定向技术, 返回一个跟用户最接近的点的IP地址

> DNS系统如何在域名解析时解析出来一个离用户最近的一个IP地址

```bash
1. 用户当前所在位置

2. 还需要知道用户现在访问的这个域名分别对应哪些IP地址，以及IP的地址?
```

> 我们不要再请求权威 dns 服务器，CDN提供商会提供这个特殊的DNS服务器

```bash
1. 从用户请求里提取出用户的ip地址, ip地址被解析为北京电信、上海移动等

2. 不能让所有用户都去修改 dns 地址呐，所以需要利用 dns 中的 cname # CDN服务器再解析，bingo
```













